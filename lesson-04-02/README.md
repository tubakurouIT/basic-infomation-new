# コンピュータの基本概念

## 主記憶装置（メインメモリ）
主記憶装置とは、**命令やデータを格納しておく装置**です。  
コンピュータの中には主記憶装置があり、プログラムの実行に必要な命令やデータが保存されます。

### 主記憶装置の構造
主記憶装置の内部は**細かく区分け**されており、各区画には**アドレス（番地）**が割り振られています。  
CPUは、アドレスを指定することで主記憶装置から命令やデータを取り出すことができます。

> **CPUは、主記憶装置のアドレスを指定し、そこに格納された命令やデータを読み出して処理する。**  
> 命令とは、コンピュータが実行する処理を指示するものであり、プログラムを構成する基本単位です。

---

## レジスタ
レジスタとは、**CPU内部にある記憶装置**であり、命令やデータを一時的に格納する役割を持ちます。  
レジスタにはいくつかの種類があり、それぞれ特定の役割を担っています。

### 主なレジスタの種類
1. **プログラムカウンター（プログラムレジスタ）**  
   - **次に実行する命令のアドレスを格納するレジスタ**

2. **命令レジスタ**  
   - **現在実行中の命令を格納するレジスタ**

3. **汎用レジスタ**  
   - **演算やデータの一時保存に利用されるレジスタ**

### フェッチとは？
CPUが主記憶装置から命令を取り出して命令レジスタに格納することを **フェッチ（Fetch）** といいます。  
命令はCPU内部の**命令デコーダ**に格納され、そこで解読されて実行されます。

---

## アドレス指定方式
CPUが主記憶装置のデータを参照するときの**アドレス指定方式**には、主に次の2種類があります。

1. **直接アドレス指定**  
   - 命令のアドレス部に**有効アドレス**（CPUが直接アクセスするアドレス）が格納されている方式。

2. **間接アドレス指定**  
   - アドレス部に記載された値が、主記憶装置内の別のアドレスを指しており、そのアドレスに**有効アドレス**が格納されている方式。

### 間接アドレス指定のメリットとデメリット
- **メリット:**  
  - アドレス部に格納できないような大きなサイズのアドレスを主記憶装置に保存できる。  
  - メモリの管理が柔軟にできるため、大規模なプログラムにも対応可能。

- **デメリット:**  
  - **処理に時間がかかる**（1回のメモリアクセスでは有効アドレスが得られず、追加のアクセスが必要）。

---

## 割り込み（Interrupt）
割り込みとは、**現在実行中のプログラムを中断して、別のプログラムに切り替えること**を指します。  
CPUが実行中の命令よりも**優先度の高い処理**が発生した場合、その処理を先に実行するために使用されます。

### 割り込みの目的
- **重要な処理を即座に実行するため**  
- **CPUのリソースを効率的に活用するため**

### 割り込みの種類
割り込みは、**発生原因**によって次の2種類に分類されます。

1. **内部割り込み（ソフトウェア割り込み）**  
   - **実行中のプログラムが原因で発生する割り込み。**  
   - 例:
     - ゼロ除算エラー
     - オーバーフロー
     - 命令の不正実行

2. **外部割り込み（ハードウェア割り込み）**  
   - **実行中のプログラム以外が原因で発生する割り込み。**  
   - 例:
     - キーボードやマウスの入力
     - タイマー割り込み（一定時間ごとに発生）
     - 外部デバイスからの要求（プリンタ、ハードディスクなど）

---

## まとめ
- **主記憶装置**は、命令やデータを保存する装置で、CPUはアドレスを指定してアクセスする。
- **レジスタ**は、CPU内部にある高速な記憶装置であり、命令やデータを一時的に保存する。
- **フェッチ**とは、命令を主記憶装置から取得し、命令レジスタに格納する処理のこと。
- **アドレス指定方式**には、直接アドレス指定と間接アドレス指定の2種類がある。
- **割り込み**は、現在の処理を中断し、優先度の高い処理を実行するための仕組みであり、内部割り込みと外部割り込みがある。

このような基本概念を理解することで、コンピュータの動作原理をより深く理解することができます。


# 割り込みの仕組みと種類

## 割り込みとは？
**割り込み（Interrupt）** とは、現在実行中のプログラムを一時的に中断し、別の処理を優先的に実行する仕組みです。  
CPUが実行中の処理よりも**優先度の高い処理**が発生した場合、CPUはその処理を即座に実行し、完了後に元の処理へ戻ります。

---

## 割り込み発生時のCPUの動作
1. 割り込みが発生すると、**CPUはプログラムカウンター（PC）にあるアドレスを別の場所（スタックメモリなど）に退避**させる。
2. 割り込み処理の命令アドレスを**プログラムカウンターにセット**し、割り込み処理を実行する。
3. 割り込み処理が完了したら、**退避させていたアドレスをプログラムカウンターに復帰**させ、元の処理を再開する。

> **CPUは割り込み処理が終わると、元の処理を正しく再開するために、プログラムカウンターの値を一時的に保存・復元する必要がある。**

---

## 割り込みの種類
割り込みは、発生原因によって**内部割り込み**と**外部割り込み**に分類されます。

### 内部割り込み（ソフトウェア割り込み）
- **実行中のプログラムが原因で発生する割り込み。**
- 例: **ゼロ除算エラー**
  - **ゼロ除算（Divide by Zero）とは？**  
    数学的に「0 で割る」ことは定義されていないため、コンピュータが 0 で除算を実行しようとするとエラーが発生し、内部割り込みが発生する。

### 外部割り込み（ハードウェア割り込み）
- **実行中のプログラム以外が原因で発生する割り込み。**
- 例: **インターバルタイマ割り込み**
  - **インターバルタイマ**とは？  
    - CPUに一定時間ごとに割り込みを発生させるタイマー。  
    - 指定した時間が経過すると割り込みが発生し、スケジューリング処理などが実行される。

---

## 割り込みの重要性
割り込みは、コンピュータが複数の処理を効率的にこなすために不可欠な仕組みです。  
特に、OS（オペレーティングシステム）は割り込みを活用して、以下のようなタスクを管理しています。

- **マルチタスク処理**（複数のプログラムを並行して実行）
- **リアルタイム応答**（キー入力や外部デバイスの信号に即座に反応）
- **エラー処理**（ゼロ除算やメモリ保護違反の検出）

---

## まとめ
- **割り込み**は、CPUが処理を中断し、優先度の高い処理を実行する仕組み。
- **割り込み発生時のCPUの動作**:
  - 現在の処理を保存し、割り込み処理を実行。
  - 割り込み処理が終わったら、元の処理を再開。
- **内部割り込み**: プログラム内部で発生（例: ゼロ除算）。
- **外部割り込み**: プログラム外部で発生（例: インターバルタイマ）。

このような仕組みを理解することで、コンピュータの動作原理をより深く学ぶことができます。
