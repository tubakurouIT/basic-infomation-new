# システムの構成とOSの役割

## 1. システムの構成
コンピュータシステムは、大きく **ハードウェア** と **ソフトウェア** の2つの要素から構成される。

### ソフトウェアの分類
ソフトウェアはさらに以下の2つに分類される。
1. **OS（オペレーティングシステム）**
   - アプリケーションソフトウェアとハードウェアの間で処理を仲介するソフトウェア。
   - 代表的なOSには以下のものがある。
     - Windows（パソコン向けで最も普及）
     - macOS（Appleのパソコン向け）
     - iOS（iPhone向け）
     - Android（多くのスマートフォン向け）
   - OSは **アプリケーションソフトウェアとハードウェアを繋ぐ架け橋** の役割を担う。

2. **アプリケーションソフトウェア**
   - ユーザーに特定の機能を提供するソフトウェア。
   - 例:
     - カメラアプリ（写真撮影）
     - メッセージアプリ（チャット、通話）

---

## 2. OSの4つの主要機能
OSには以下の4つの主要機能がある。

1. **ジョブ管理**
2. **タスク管理**
3. **記憶管理**
4. **データ管理**

### 2.1 ジョブ管理
**ジョブ管理とは**  
ユーザーがコンピュータに依頼する処理（ジョブ）の実行順序を管理する機能。

- **ジョブとは**  
  - ユーザーがコンピュータに依頼する仕事の単位。
  - 例:
    - 書類の印刷
    - ファイルのコピー

- **ジョブの処理の流れ**
  1. OSがユーザーからジョブを受け取る。
  2. OSがジョブを **タスク（より細かい単位）** に分解し、CPUに渡す。
  3. CPUがタスクを実行する。

- **ジョブ管理が必要な理由**
  - CPUとその他のハードウェアの処理速度が大幅に異なるため、適切な制御が必要。

- **関連技術**
  - **スプーリング**
    - CPUと低速の入出力装置の間でデータを高速の補助記憶装置に一時保存し、スムーズな処理を実現する技術。
  - **バッファ（緩衝記憶装置）**
    - 処理速度の異なる2つの装置間のデータのやり取りを円滑にするために、一時的にデータを保存する記憶装置。

---

### 2.2 タスク管理
**タスク管理とは**  
タスク（OSがCPUに出す命令）の実行順序を管理する機能。

- **タスクとジョブの違い**
  - **ジョブ**: ユーザーがコンピュータに出す依頼（例: 印刷）
  - **タスク**: OSがジョブを分解し、CPUに実行させる単位

- **マルチタスク**
  - OSがCPUの操作を管理し、複数のタスクを高速で切り替えることで、あたかも同時に実行されているように見せる技術。

- **タスクの切り替え方法**
  1. **プリエンプティブ方式**
     - CPUの使用権をOSが管理し、優先度の高いタスクに割り当てる。
  2. **ノンプリエンプティブ方式**
     - CPUの使用権をタスク自身が管理し、処理が完了するまで使用し続ける。

- **タスクの3つの状態**
  1. **実行可能状態**（待機中）
  2. **実行状態**（CPUが処理中）
  3. **待ち状態**（入出力待ちなどで一時停止中）

- **ディスパッチ**
  - OSがタスクを **実行可能状態** から **実行状態** に移す操作。

- **タスクスケジューリング（タスクの実行順を決定）**
  - **代表的なスケジューリング方式**
    1. **到着順方式**（先に到着したタスクから順に実行）
    2. **処理時間順方式**（処理時間の短いタスクを優先）
    3. **優先度順方式**（タスクに優先度を設定し、高いものから実行）
    4. **ラウンドロビン方式**（一定時間ごとにタスクを切り替えて実行）

---

## 3. まとめ
OSはコンピュータの基本的な制御を担い、以下のような機能を提供する。

- **ジョブ管理**: ユーザーの依頼（ジョブ）を整理し、適切に処理する。
- **タスク管理**: ジョブを細分化し、CPUで効率よく処理させる。
- **記憶管理**: メモリの割り当て・管理を行う。
- **データ管理**: ファイルやデータの管理を行う。

特に、タスク管理では **マルチタスク** や **スケジューリング** の仕組みを利用し、システム全体の効率化を図る。

このように、OSはコンピュータの動作を支え、ユーザーが快適に利用できる環境を提供している。


# 記憶管理とデータ管理

## 1. 記憶管理
記憶管理とは、**記憶装置（メモリ）を効率的に利用するための機能** である。  
記憶管理は以下の2つに分類される。

1. **主記憶管理**（物理メモリの管理）
2. **仮想記憶管理**（補助記憶装置を活用した管理）

---

### 1.1 仮想記憶管理
**仮想記憶管理とは**  
補助記憶装置（HDDやSSD）の一部を、**あたかも主記憶装置（RAM）であるかのように扱う方式**。

- **仮想記憶**: OSが論理的に作り出した記憶領域  
- **実記憶**: 主記憶装置（RAM）の物理的な記憶領域

この仕組みにより、実際のRAM容量以上のメモリがあるように見せかけ、大きなプログラムの実行や複数のプロセスの同時実行が可能になる。

---

### 1.2 仮想記憶管理の方式
仮想記憶管理には **セグメンテーション方式** と **ページング方式** の2種類がある。

#### **セグメンテーション方式**
- **可変長** の領域（セグメント）に分割して管理する方式。
- プログラムの論理的な構造に基づいて分割。
- **メリット**: メモリの無駄が少ない。
- **デメリット**: 外部フラグメンテーション（断片化）が発生しやすい。

#### **ページング方式**
- **固定長** の領域（ページ）に分割して管理する方式。
- 仮想記憶を「ページ」、実記憶を「ページフレーム」に分ける。
- **メリット**: 外部フラグメンテーションが発生しにくい。
- **デメリット**: 内部フラグメンテーション（ページサイズより小さいデータの無駄）が発生する。

---

### 1.3 仮想アドレスと物理アドレス
- **仮想アドレス**: OSが仮想記憶上で管理するアドレス（論理アドレス）
- **物理アドレス**: 実際に主記憶上で割り当てられるアドレス
- **ページテーブル**: 仮想アドレスと物理アドレスの対応関係を管理するデータ構造  
  - 仮想記憶にあるページの総数とページテーブルの行の総数は同じ。

---

### 1.4 ページフォールト
**ページフォールトとは**  
- 実記憶に存在しないページへのアクセスが発生したときに起こる割り込み処理。
- 必要なページを補助記憶装置から主記憶へロードする。

#### **ページフォールトの処理**
1. **ページイン**: 必要なページを補助記憶装置から主記憶へ読み込む。
2. **ページアウト**: 使用頻度の低いページを主記憶から補助記憶装置へ退避する。

ページフォールトが頻発すると、システムのパフォーマンスが大幅に低下する。

---

### 1.5 ページの置き換えアルゴリズム
ページフォールトが発生した際、どのページをページアウトするかを決める **ページ置き換えアルゴリズム** には以下の3種類がある。

1. **LRU（Least Recently Used, 最小最近使用）**
   - **最近使われていないページ** を優先的に置き換える方式。
   - **メリット**: 効率的に不要なページを除外できる。
   - **デメリット**: ページの使用履歴を記録するコストが高い。

2. **LFU（Least Frequently Used, 最小使用頻度）**
   - **参照回数が最も少ないページ** を置き換える方式。
   - **メリット**: 頻繁に使われるページを保持しやすい。
   - **デメリット**: たまたま短期間にアクセスされたページが残る可能性がある。

3. **FIFO（First-In-First-Out, 先入れ先出し）**
   - **最も古くロードされたページ** を優先的に置き換える方式。
   - **メリット**: 実装が簡単。
   - **デメリット**: 頻繁に使用されるページも置き換えられる可能性がある。

---

### 1.6 スラッシング
**スラッシングとは**  
- 仮想記憶管理において、ページイン・ページアウトが頻繁に発生し、システムの処理能力が低下する現象。
- **原因**:
  - 実記憶の容量が小さい
  - ページフォールトが多発する

スラッシングが発生すると、コンピュータのスループット（処理能力）が著しく低下するため、適切なメモリ管理が重要となる。

---

## 2. データ管理
**データ管理とは**  
コンピュータが処理するデータを適切に管理する機能。

### 2.1 データ管理の主な機能
1. **ファイルシステム**
   - データをファイルとして保存・管理する仕組み。
   - 例: NTFS, FAT32, ext4 などのファイルシステム。

2. **バックアップ**
   - データの損失を防ぐため、定期的にコピーを保存する仕組み。
   - 例:
     - フルバックアップ（すべてのデータを保存）
     - 差分バックアップ（前回のバックアップ以降に変更されたデータのみ保存）
     - 増分バックアップ（前回のバックアップ時点からの変更のみ保存）

---

## 3. まとめ
記憶管理とデータ管理は、コンピュータの効率的な動作に不可欠な要素である。

- **記憶管理**
  - 主記憶と仮想記憶を適切に管理し、メモリを効率よく使用する。
  - 仮想記憶管理では **ページング方式** や **セグメンテーション方式** が活用される。
  - **ページフォールト** や **スラッシング** の発生を防ぐため、適切なメモリ管理が求められる。

- **データ管理**
  - **ファイルシステム** や **バックアップ** によって、データの整合性と安全性を確保する。

これらの管理機能により、コンピュータは安定して動作し、ユーザーの利便性が向上する。
